<!DOCTYPE html>
<html lang="en">

<head>
    <title>vfx.coop</title>
    <meta name="description" content="the.vfx.cooperative">
    <link href="css/bootstrap-5.0.0-beta2-dist/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <script src="js/bootstrap-5.0.0-beta2-dist/bootstrap.bundle.min.js"></script>
    <script src="https://www.google.com/recaptcha/enterprise.js" async defer></script>
</head>

<body class="bg-dark text-light">
    <div class="d-flex flex-column align-items-center" style="min-height: 100vh">
        <div class="p-2 flex-grow-1"></div>
        <div class="display-1">vfx.coop</div>
        <div class="text-uppercase">
            First Floor // 85 Great Portland Street // London // W1W 7LT
        </div>
        <div class="p-2 flex-grow-1"><button type="button" class="btn btn-dark" data-bs-toggle="modal"
                data-bs-target="#contactus">Contact Us</button></div>
    </div>

    <!-- Toast -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 5">
        <div class="toast text-white bg-danger border-0" role="alert">
            <div class="d-flex">
                <div class="toast-body"></div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
        </div>
    </div>

    <!-- Contact Us -->
    <div class="modal" id="contactus" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark">
                <form id="contactus" class="needs-validation" method="POST"
                    action="https://hd5ypo8gh5.execute-api.eu-west-2.amazonaws.com/test/contactus" novalidate>
                    <input type="hidden" name="repository" value="core">
                    <div class="modal-header">
                        <h5 class="modal-title">Contact Us</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="textarea" class="form-label">Tell us a story</label>
                            <textarea class="form-control" name="text" rows="3" required></textarea>
                            <div class="invalid-feedback">
                                We need a story
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">How can we communicate</label>
                            <input type="email" class="form-control" name="email" placeholder="name@example.com"
                                required>
                            <div class="invalid-feedback">
                                We'd like to communicate
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <div class="g-recaptcha" data-sitekey="6LfhCZAaAAAAAOeNjSPPd-Qxl6_4F7wFWbqL807X"></div>
                        <button type="submit" class="btn btn-secondary">I'm not a robot</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Script -->
    <script type="text/javascript">
        var form = document.querySelector(".needs-validation");
        var toast = new bootstrap.Toast(document.querySelector(".toast"));
        var modal = new bootstrap.Toast(document.querySelector(".modal"));
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            event.stopPropagation();
            if (form.checkValidity()) {
                var data = {};
                new FormData(form).forEach(function (value, key) {
                    data[key] = value;
                });
                fetch(form.action, {
                    headers: {
                        "Accept": "application/json",
                        "Content-Type": "application/json",
                    },
                    method: "POST",
                    body: JSON.stringify(data),
                }).then(function (response) {
                    document.querySelector(".toast-body").innerText = response.statusText;
                    modal.hide();
                    toast.show();
                    form.text.value = "";
                    form.email.value = "";
                }).catch(function (error) {
                    document.querySelector(".toast-body").innerText = error;
                    modal.hide();
                    toast.show();
                })
            }
            form.classList.add('was-validated');
        }, false);
    </script>
</body>

</html>